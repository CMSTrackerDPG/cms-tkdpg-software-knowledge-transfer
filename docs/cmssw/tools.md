# Tools

It all starts with `cmsRun` which is the main entry point to all CMSSW code.
Configuring it can be a pain so, for this reason, `cmsDriver` was built.
Still, configuring `cmsDriver` can also be tedious for pipelines that require
multiple steps of data fetching, configuring, simulating etc., so `runTheMatrix.py`
was developed.

Those tools are available on LXPLUS machines, after creating a work area
and [activating a CMSSW environment by `cmsenv`](working-with-cmssw/setup.md#create-a-cmssw-area).

## `scram`

A software build and maintenance tool [written in Python](https://github.com/cms-sw/SCRAM/tree/SCRAMV3/SCRAM).
It calls `gmake` under the hood.

It can [build](working-with-cmssw/setup.md#building-the-code),
[check](working-with-cmssw/setup.md#running-checks-on-the-code)
and [format](working-with-cmssw/setup.md#formatting-the-code) the code.

Documentation on `scram` can be found [here](https://twiki.cern.ch/twiki/bin/view/CMSPublic/SWGuideScram).

### Extra Parameters

- Scram also accepts extra flags which are passed directly to `gmake` such as `--dry-run`.
- The `USER_CXXFLAGS` is an environmental variable which is used to pass arguments to `g++`:
    - For enabling `LogDebug` messages, also add `USER_CXXFLAGS="-DEDM_ML_DEBUG"` before the `scram` command.
    - For also defining the `GPU_DEBUG` flag globally (for GPU code), add
    `USER_CXXFLAGS="-g -DGPU_DEBUG -DEDM_ML_DEBUG"` before the `scram` command.
    - If your debug build is not working, you might need to clean your development area:
    ``` bash
    scram b clean
    ```

### Rebuilding

If you built CMSSW, changed a file and rebuilt it, some cached object files may still
be there. It's recommended to always run `scram b clean` before re-running `scram b`.

### Multiple jobs

Note that running `scram b` with multiple jobs launches multiple threads on multiple source
files. The compilation order will not be predictable, and the complilation messages
will not be predictable.

## `cmsRun`

!!! todo
	
	TODO
	
The main entrypoint to execute CMSSW code. Probably never run by hand, it requires
complicated [configuration files](https://twiki.cern.ch/twiki/bin/view/CMSPublic/WorkBookConfigFileIntro) 
to execute which are generated by other tools, described below.

## `cmsDriver.py`

!!! todo
	
	TODO

A Python tool to create `cmsRun` configuration files, which are in the form of Python3 code.


### Resources
1. [Source code](https://github.com/cms-sw/cmssw/blob/master/Configuration/Applications/scripts/cmsDriver.py)
2. [Twiki page](https://twiki.cern.ch/twiki/bin/view/CMSPublic/SWGuideCmsDriver)

## `runTheMatrix.py`

A wrapper script which is responsible of executing multi-step analysis/simulation recipes
by configuring `cmsDriver`.

It is examined in more detail [in the Workflows section](workflows/overview.md)


